<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.goodee.app.account.AccountDAO">
  	
  	<insert id="add" parameterType="AccountDTO">
  		INSERT INTO ACCOUNT_INFO (ACCOUNT_NUM, USER_ID, PRODUCT_NUM, BALANCE, ACCOUNT_DATE)
		VALUES (#{account_num}, #{user_id}, #{product_num}, 0, SYSDATE)
  	</insert>
  	
  	<select id="detail" parameterType="AccountDTO" resultMap="detailResult">
  		SELECT P.PRODUCT_NAME, P.PRODUCT_RATE, A.* FROM PRODUCT_INFO P
		INNER JOIN ACCOUNT_INFO A
		ON P.PRODUCT_NUM = A.PRODUCT_NUM 
		WHERE A.ACCOUNT_NUM = #{account_num}
  	</select>
  	
  	<resultMap type="AccountDTO" id="detailResult">
  		<id column="ACCOUNT_NUM" property="account_num" />
  		<result column="USER_ID" property="user_id" />
  		<result column="PRODUCT_NUM" property="product_num" />
  		<result column="BALANCE" property="balance" />
  		<result column="ACCOUNT_DATE" property="account_date" />
  		<!-- 1 : 1의 관계 -->
  		<association property="productDTO" javaType="ProductDTO">
  			<result column="PRODUCT_NAME" property="product_name"/>
  			<result column="PRODUCT_RATE" property="product_rate"/>		
  		</association>
  	</resultMap>

 
  </mapper>